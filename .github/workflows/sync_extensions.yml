name: Sync Extensions on PR merge

on:
  pull_request:
    types: [closed]
    branches: [main]

# on:
#   push:
#     branches:
#         - main

jobs:
  sync_extensions:
    if: ${{ github.event.pull_request.merged == true }}
    runs-on: ubuntu-latest
    steps:
      - name: Checkout SDK
        uses: actions/checkout@v4
        with:
          persist-credentials: false
      
      - name: Sync LiveRamp
        uses: ./.github/actions/sync-extension
        with:
          name: LiveRamp
          extension-path: Extensions/Sources/LiveRamp
          repository: standa-dev/gh-liveramp
          token: ${{ secrets.NIMBUS_PAT }}

      - name: Sync AdMob
        uses: ./.github/actions/sync-extension
        with:
          name: AdMob
          extension-path: Extensions/Sources/NimbusAdMobKit
          repository: standa-dev/gh-admob
          token: ${{ secrets.NIMBUS_PAT }}
          
